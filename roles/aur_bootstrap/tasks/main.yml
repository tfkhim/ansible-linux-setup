# Private Ansible playbook
#
# Copyright (C) 2018 T. Himmelstoss
#
# This software may be freely distributed under the MIT license. You should
# have received a copy of the MIT License along with this program.

- name: Install required packages
  package:
    name: [base-devel, git]
    state: present

- name: Add user '{{aur_build_user}}' for building AUR packages
  user:
    name: '{{aur_build_user}}'
    state: present

- name: Allow user '{{aur_build_user}}' to call pacman without password
  template:
    src: 02_aur_build_user.j2
    dest: /etc/sudoers.d/02_aur_build_user
    owner: root
    group: root
    mode: u=r,g=r
    validate: /usr/sbin/visudo -csf %s

- name: Create a directory for AUR checkouts
  become_user: '{{aur_build_user}}'
  file:
    path: '{{aur_build_dir}}'
    state: directory

